"use strict";(self["webpackChunkbuilding_material_mgr_fe"]=self["webpackChunkbuilding_material_mgr_fe"]||[]).push([[326],{6792:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(3396),i=a(7139);const l={key:0},s=["onClick"];function r(e,t,a,r,c,o){const u=(0,n.up)("a-divider"),m=(0,n.up)("a-table"),p=(0,n.up)("a-pagination"),d=(0,n.up)("flex-end"),g=(0,n.up)("a-card"),v=(0,n.up)("a-spin");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(v,{spinning:e.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{title:e.simple?"最近的操作日志":""},{default:(0,n.w5)((()=>[e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("h2",l,"操作日志")),e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(u,{key:1})),(0,n.Wm)(m,{bordered:"","data-source":e.list,columns:e.columns,pagination:!1},(0,n.Nv)({createdAt:(0,n.w5)((({record:t})=>[(0,n.Uk)((0,i.zw)(e.formatTimeStamp(t.meta.createAt)),1)])),_:2},[e.simple?void 0:{name:"action",fn:(0,n.w5)((({record:t})=>[(0,n._)("a",{href:"javascript:;",onClick:a=>e.remove(t)},"删除",8,s)]))}]),1032,["data-source","columns"]),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(p,{key:0,style:{"margin-top":"24px"},current:e.curPage,"onUpdate:current":t[0]||(t[0]=t=>e.curPage=t),pageSize:20,total:e.total,onChange:e.setPage},null,8,["current","total","onChange"]))])),_:1})])),_:1},8,["title"])])),_:1},8,["spinning"])])}var c=a(4870),o=a(3926),u=a(1731);const m=[["/character/list","获取角色列表"],["/log/list","获取日志列表"],["/user/info","获取自己的登入信息"]],p=e=>{let t="";return m.forEach((a=>{e.includes(a[0])&&(t=e.replace(a[0],a[1]))})),t||e};var d=a(252);var g=(0,n.aZ)({props:{simple:Boolean},setup(e){const t=[{title:"用户名",dataIndex:"user.account"},{title:"动作",dataIndex:"action"},{title:"记录时间",slots:{customRender:"createdAt"}}];e.simple||t.push({title:"操作",slots:{customRender:"action"}});const a=(0,c.iH)(1),i=(0,c.iH)(0),l=(0,c.iH)([]),s=(0,c.iH)(!0),r=async()=>{s.value=!0;const e=await o.cM.list(a.value,20);s.value=!1,(0,u.q6)(e).success((({data:{list:e,total:t}})=>{e.forEach((e=>{e.action=p(e.request.url)})),l.value=e,i.value=t}))};(0,n.bv)((()=>{r()}));const m=e=>{a.value=e,r()},g=async({_id:e})=>{const t=await o.cM.remove(e);(0,u.q6)(t).success((({msg:e})=>{d.Z.success(e)}))};return{curPage:a,total:i,list:l,columns:t,setPage:m,loading:s,formatTimeStamp:u.jH,remove:g,simple:e.simple}}}),v=a(89);const f=(0,v.Z)(g,[["render",r]]);var w=f}}]);
//# sourceMappingURL=log.e76ba495.js.map