{"version":3,"file":"js/log.aede59b5.js","mappings":"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","sources":["webpack://building-material-mgr-fe/./src/views/Log/index.vue","webpack://building-material-mgr-fe/./src/helpers/log/index.js","webpack://building-material-mgr-fe/./src/views/Log/index.js","webpack://building-material-mgr-fe/./src/views/Log/index.vue?684c"],"sourcesContent":["<template>\r\n  <div>\r\n    <a-spin :spinning = \"loading\">\r\n      <a-card :title=\"simple? '最近的操作日志' : '' \">\r\n\r\n        <h2 v-if=\"!simple\">操作日志</h2>\r\n\r\n        <a-divider  v-if=\"!simple\"/>\r\n\r\n        <a-table\r\n          bordered\r\n          :data-source=\"list\"\r\n          :columns=\"columns\"\r\n          :pagination=\"false\"\r\n        >\r\n\r\n        <template #createdAt =\"{ record }\">\r\n            {{formatTimeStamp(record.meta.createAt)}}\r\n        </template>\r\n\r\n        <template #action =\"{ record }\" v-if=\"!simple\">\r\n            <a href=\"javascript:;\" @click=\"remove(record)\">删除</a>\r\n        </template>\r\n\r\n        </a-table>\r\n\r\n        <flex-end>\r\n          <a-pagination\r\n            style=\"margin-top: 24px\"\r\n            v-model:current=\"curPage\"\r\n            :pageSize=\"20\"\r\n            :total=\"total\"\r\n            @change=\"setPage\"\r\n            v-if=\"!simple\"\r\n          />\r\n        </flex-end>\r\n      </a-card>\r\n    </a-spin>\r\n  </div>\r\n</template>\r\n<script src=\"./index.js\">\r\n</script>","const LOG_MAP = [\r\n    ['/character/list','获取角色列表'],\r\n    ['/log/list','获取日志列表'],\r\n    ['/user/info','获取自己的登入信息'],\r\n];\r\n\r\n\r\nexport const getLogInfoByPath = (path)=>{\r\n\r\n    let title= '';\r\n    LOG_MAP.forEach((item)=>{\r\n        if(path.includes(item[0])){\r\n            title = path.replace(item[0],item[1]);\r\n        }\r\n    });\r\n    return title || path;\r\n}","import { defineComponent,onMounted,ref } from \"vue\";\r\nimport { log } from '@/service'\r\nimport { result,formatTimeStamp } from \"@/helpers/utils\";\r\nimport { getLogInfoByPath } from \"@/helpers/log\";\r\nimport { message } from \"ant-design-vue\";\r\nconst columns = [\r\n    {\r\n        title: '用户名',\r\n        dataIndex: 'user.account'\r\n    },\r\n    {\r\n        title: '动作',\r\n        dataIndex: 'action'\r\n    },\r\n    {\r\n        title: '记录时间',\r\n        slots: {\r\n            customRender: 'createdAt'\r\n            }\r\n    },\r\n    {\r\n        title: '操作',\r\n        slots: {\r\n            customRender: 'action'\r\n            }\r\n    },\r\n    // {\r\n    //     title: '库存 /件',\r\n    //     dataIndex: '',\r\n    //     slots: {\r\n    //         customRender: 'count'\r\n    //     }\r\n    // },\r\n]\r\n\r\nexport default defineComponent({\r\n    props:{\r\n        simple:Boolean\r\n    },\r\n\r\n    setup(props){\r\n        const columns = [\r\n            {\r\n                title: '用户名',\r\n                dataIndex: 'user.account'\r\n            },\r\n            {\r\n                title: '动作',\r\n                dataIndex: 'action'\r\n            },\r\n            {\r\n                title: '记录时间',\r\n                slots: {\r\n                    customRender: 'createdAt'\r\n                    }\r\n            },\r\n\r\n        ]\r\n        if(!props.simple){\r\n            columns.push(            {\r\n                title: '操作',\r\n                slots: {\r\n                    customRender: 'action'\r\n                    }\r\n            })\r\n        }\r\n\r\n        const curPage = ref(1);\r\n        const total = ref(0);\r\n        const list = ref([]);\r\n        const loading = ref(true);\r\n\r\n\r\n        const getList = async ()=>{\r\n            loading.value = true;\r\n            const res = await  log.list(curPage.value,20);\r\n            loading.value = false;\r\n\r\n            result(res)\r\n             .success(( {data :{ list:l ,total:t }})=>{\r\n                l.forEach((item)=>{\r\n                    item.action = getLogInfoByPath(item.request.url)\r\n                    \r\n                });\r\n                \r\n                list.value = l;\r\n                total.value = t;\r\n             });\r\n        }\r\n\r\n        onMounted(()=>{\r\n            getList();\r\n        });\r\n\r\n        const setPage = (page)=>{\r\n            curPage.value = page;\r\n            getList();\r\n        }\r\n\r\n        const remove =async({ _id })=>{\r\n            const res = await log.remove(_id);\r\n            result(res)\r\n             .success(({msg })=>{\r\n                 message.success(msg)\r\n             });\r\n        }\r\n        return {\r\n            curPage,\r\n            total,\r\n            list,\r\n            columns,\r\n            setPage,\r\n            loading,\r\n            formatTimeStamp,\r\n            remove,\r\n            simple:props.simple\r\n        }\r\n\r\n    }\r\n})","import { render } from \"./index.vue?vue&type=template&id=e5909912\"\nimport script from \"./index.js?vue&type=script&lang=js\"\nexport * from \"./index.js?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Molly Wang\\\\Desktop\\\\project\\\\building-material-mgr-fe\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","_createVNode","_component_a_spin","spinning","_ctx","_component_a_card","title","_hoisted_1","_createBlock","_component_a_divider","key","_component_a_table","bordered","columns","pagination","createdAt","record","meta","createAt","_createElementVNode","href","onClick","_hoisted_2","_component_flex_end","_component_a_pagination","style","current","$event","pageSize","total","onChange","LOG_MAP","getLogInfoByPath","path","forEach","item","includes","replace","defineComponent","props","simple","Boolean","setup","dataIndex","slots","customRender","push","curPage","ref","list","loading","getList","async","value","res","log","result","success","data","l","t","action","request","url","onMounted","setPage","page","remove","_id","msg","message","formatTimeStamp","__exports__","render"],"sourceRoot":""}